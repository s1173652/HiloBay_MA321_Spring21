ggtitle("Storms")+labs(x="Time")
print(plot)
}
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~.*0.02, name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
ggtitle("Storms")+labs(x="Time")
print(p)
}
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~.*0.02, name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
ggtitle("Storms")+labs(x="Time")
print(p)
}
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~.*0.02, name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
p < - p + ggtitle("Storms")+labs(x="Time")
print(p)
}
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~.*0.02, name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
p <- p + ggtitle("Storms")+labs(x="Time")
print(p)
}
# p <- ggplot(obs, aes(x = Timestamp))
#   p <- p + geom_line(aes(y = air_temp, colour = "Temperature"))
#
#   # adding the relative humidity data, transformed to match roughly the range of the temperature
#   p <- p + geom_line(aes(y = rel_hum/5, colour = "Humidity"))
#
#   # now adding the secondary axis, following the example in the help file ?scale_y_continuous
#   # and, very important, reverting the above transformation
#   p <- p + scale_y_continuous(sec.axis = sec_axis(~.*5, name = "Relative humidity [%]"))
#
#   # modifying colours and theme options
#   p <- p + scale_colour_manual(values = c("blue", "red"))
#   p <- p + labs(y = "Air temperature [°C]",
#                 x = "Date and time",
#                 colour = "Parameter")
#   p <- p + theme(legend.position = c(0.8, 0.9))
# p
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
#p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~., name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
p <- p + ggtitle("Storms")+labs(x="Time")
print(p)
}
# p <- ggplot(obs, aes(x = Timestamp))
#   p <- p + geom_line(aes(y = air_temp, colour = "Temperature"))
#
#   # adding the relative humidity data, transformed to match roughly the range of the temperature
#   p <- p + geom_line(aes(y = rel_hum/5, colour = "Humidity"))
#
#   # now adding the secondary axis, following the example in the help file ?scale_y_continuous
#   # and, very important, reverting the above transformation
#   p <- p + scale_y_continuous(sec.axis = sec_axis(~.*5, name = "Relative humidity [%]"))
#
#   # modifying colours and theme options
#   p <- p + scale_colour_manual(values = c("blue", "red"))
#   p <- p + labs(y = "Air temperature [°C]",
#                 x = "Date and time",
#                 colour = "Parameter")
#   p <- p + theme(legend.position = c(0.8, 0.9))
# p
for(i in 1:length(start)){
index <- (start[i]-24):(end[i]+24)
date <- c(hilomodified$date[(start[i]-24):(end[i]+24)])
enddate <- hilomodified$date[end[i]+24]
endcms <- as.numeric(hilomodified$cms[end[i]+24])
endchl <- range01(as.numeric(hilomodified$cms[end[i]+24]))
endturb <- as.numeric(hilomodified$cms[end[i]+24])
endsalt <- as.numeric(hilomodified$cms[end[i]+24])
endtemp <- as.numeric(hilomodified$cms[end[i]+24])
endDO <- as.numeric(hilomodified$cms[end[i]+24])
par(mar = c(5, 4, 4, 4) + 0.3) # Additional space for second y-axis
plot(x = date,y = as.numeric(hilomodified$cms[(start[i]-24):(end[i]+24)]), type = "l",lwd=2, col="black", xlab="Time") # Create first plot for River Flow
par(new = TRUE) # Add new plot
plot(x = date ,y = range01(as.numeric(hilomodified$ChlRFU[(start[i]-24):(end[i]+24)])),axes = FALSE, type = "l",lwd=2, col="blue", ylab = "Time")  # Create second plot without axes
lines(x = date ,y = range01(as.numeric(hilomodified$Corr.NTU[(start[i]-24):(end[i]+24)])), type = "l",lwd=2, col="red")
lines(x = date ,y = range01(as.numeric(hilomodified$saltppt[(start[i]-24):(end[i]+24)])), type = "l",lwd=2, col="green")
lines(x = date ,y = range01(as.numeric(hilomodified$TempC[(start[i]-24):(end[i]+24)])), type = "l",lwd=2, col="orange")
lines(x = date ,y = range01(as.numeric(hilomodified$Doper[(start[i]-24):(end[i]+24)])), type = "l",lwd=2, col="purple")
axis(side = 4)   # Add second axis
#mtext("y2", side = 4, line = 3) # Add second axis label
text(x= enddate, y = endcms, col = "black", adj=1, cex=0.85, label= "River Flow")
text(x= enddate, y = endchl, col = "blue", adj=1, cex=0.85, label= "CHL")
text(x= enddate, y = endturb, col = "red", adj=1, cex=0.85, label= "TURB")
text(x= enddate, y = endsalt, col = "green", adj=1, cex=0.85, label= "Salinity")
text(x= enddate, y = endtemp, col = "orange", adj=1, cex=0.85, label= "TEMP")
text(x= enddate, y = endDO, col = "purple", adj=1, cex=0.85, label= "DIS")
}
for(i in 1:length(start)){
index <- c((start[i]-24):(end[i]+24))
date <- c(hilomodified$date[index]
enddate <- hilomodified$date[end[i]+24]
index <- c((start[1]-24):(end[1]+24))
index
for(i in 1:length(start)){
index <- c((start[i]-24):(end[i]+24))
date <- c(hilomodified$date[index]
enddate <- hilomodified$date[end[i]+24]
for(i in 1:length(start)){
index <- c((start[i]-24):(end[i]+24))
date <- c(hilomodified$date[index])
enddate <- hilomodified$date[end[i]+24]
endcms <- as.numeric(hilomodified$cms[end[i]+24])
endchl <- range01(as.numeric(hilomodified$cms[end[i]+24]))
endturb <- as.numeric(hilomodified$cms[end[i]+24])
endsalt <- as.numeric(hilomodified$cms[end[i]+24])
endtemp <- as.numeric(hilomodified$cms[end[i]+24])
endDO <- as.numeric(hilomodified$cms[end[i]+24])
par(mar = c(5, 4, 4, 4) + 0.3) # Additional space for second y-axis
plot(x = date,y = as.numeric(hilomodified$cms[index]), type = "l",lwd=2, col="black", xlab="Time") # Create first plot for River Flow
par(new = TRUE) # Add new plot
plot(x = date ,y = range01(as.numeric(hilomodified$ChlRFU[index])),axes = FALSE, type = "l",lwd=2, col="blue", ylab = "Time")  # Create second plot without axes
lines(x = date ,y = range01(as.numeric(hilomodified$Corr.NTU[index])), type = "l",lwd=2, col="red")
lines(x = date ,y = range01(as.numeric(hilomodified$saltppt[index])), type = "l",lwd=2, col="green")
lines(x = date ,y = range01(as.numeric(hilomodified$TempC[index])), type = "l",lwd=2, col="orange")
lines(x = date ,y = range01(as.numeric(hilomodified$Doper[index])), type = "l",lwd=2, col="purple")
axis(side = 4)   # Add second axis
#mtext("y2", side = 4, line = 3) # Add second axis label
text(x= enddate, y = endcms, col = "black", adj=1, cex=0.85, label= "River Flow")
text(x= enddate, y = endchl, col = "blue", adj=1, cex=0.85, label= "CHL")
text(x= enddate, y = endturb, col = "red", adj=1, cex=0.85, label= "TURB")
text(x= enddate, y = endsalt, col = "green", adj=1, cex=0.85, label= "Salinity")
text(x= enddate, y = endtemp, col = "orange", adj=1, cex=0.85, label= "TEMP")
text(x= enddate, y = endDO, col = "purple", adj=1, cex=0.85, label= "DIS")
}
plot(NA)
plot(0,0)
for(i in 1:length(start)){
index <- c((start[i]-24):(end[i]+24))
if(is.na(as.numeric(hilomodified$ChlRFU[index])) && is.na(as.numeric(hilomodified$Corr.NTU[index])) && is.na(as.numeric(hilomodified$saltppt[index])) && is.na(as.numeric(hilomodified$TempC[index])) && is.na) == FALSE){
for(i in 1:length(start)){
index <- c((start[i]-24):(end[i]+24))
if((is.na(as.numeric(hilomodified$ChlRFU[index])) && is.na(as.numeric(hilomodified$Corr.NTU[index])) && is.na(as.numeric(hilomodified$saltppt[index])) && is.na(as.numeric(hilomodified$TempC[index])) && is.na(as.numeric(hilomodified$Doper[index]))) == FALSE){
plot(0,0)
}
date <- c(hilomodified$date[index])
enddate <- hilomodified$date[end[i]+24]
endcms <- as.numeric(hilomodified$cms[end[i]+24])
endchl <- range01(as.numeric(hilomodified$cms[end[i]+24]))
endturb <- as.numeric(hilomodified$cms[end[i]+24])
endsalt <- as.numeric(hilomodified$cms[end[i]+24])
endtemp <- as.numeric(hilomodified$cms[end[i]+24])
endDO <- as.numeric(hilomodified$cms[end[i]+24])
par(mar = c(5, 4, 4, 4) + 0.3) # Additional space for second y-axis
plot(x = date,y = as.numeric(hilomodified$cms[index]), type = "l",lwd=2, col="black", xlab="Time") # Create first plot for River Flow
par(new = TRUE) # Add new plot
plot(x = date ,y = range01(as.numeric(hilomodified$ChlRFU[index])),axes = FALSE, type = "l",lwd=2, col="blue", ylab = "Time")  # Create second plot without axes
lines(x = date ,y = range01(as.numeric(hilomodified$Corr.NTU[index])), type = "l",lwd=2, col="red")
lines(x = date ,y = range01(as.numeric(hilomodified$saltppt[index])), type = "l",lwd=2, col="green")
lines(x = date ,y = range01(as.numeric(hilomodified$TempC[index])), type = "l",lwd=2, col="orange")
lines(x = date ,y = range01(as.numeric(hilomodified$Doper[index])), type = "l",lwd=2, col="purple")
axis(side = 4)   # Add second axis
#mtext("y2", side = 4, line = 3) # Add second axis label
text(x= enddate, y = endcms, col = "black", adj=1, cex=0.85, label= "River Flow")
text(x= enddate, y = endchl, col = "blue", adj=1, cex=0.85, label= "CHL")
text(x= enddate, y = endturb, col = "red", adj=1, cex=0.85, label= "TURB")
text(x= enddate, y = endsalt, col = "green", adj=1, cex=0.85, label= "Salinity")
text(x= enddate, y = endtemp, col = "orange", adj=1, cex=0.85, label= "TEMP")
text(x= enddate, y = endDO, col = "purple", adj=1, cex=0.85, label= "DIS")
}
for(i in 1:length(start)){
index <- c((start[i]-24):(end[i]+24))
TF <-  (is.na(as.numeric(hilomodified$ChlRFU[index]))  && is.na(as.numeric(hilomodified$Corr.NTU[index])) && is.na(as.numeric(hilomodified$saltppt[index])) && is.na(as.numeric(hilomodified$TempC[index])) && is.na(as.numeric(hilomodified$Doper[index])))
if(TF == TRUE){
plot(0,0)
}
date <- c(hilomodified$date[index])
enddate <- hilomodified$date[end[i]+24]
endcms <- as.numeric(hilomodified$cms[end[i]+24])
endchl <- range01(as.numeric(hilomodified$cms[end[i]+24]))
endturb <- as.numeric(hilomodified$cms[end[i]+24])
endsalt <- as.numeric(hilomodified$cms[end[i]+24])
endtemp <- as.numeric(hilomodified$cms[end[i]+24])
endDO <- as.numeric(hilomodified$cms[end[i]+24])
par(mar = c(5, 4, 4, 4) + 0.3) # Additional space for second y-axis
plot(x = date,y = as.numeric(hilomodified$cms[index]), type = "l",lwd=2, col="black", xlab="Time") # Create first plot for River Flow
par(new = TRUE) # Add new plot
plot(x = date ,y = range01(as.numeric(hilomodified$ChlRFU[index])),axes = FALSE, type = "l",lwd=2, col="blue", ylab = "Time")  # Create second plot without axes
lines(x = date ,y = range01(as.numeric(hilomodified$Corr.NTU[index])), type = "l",lwd=2, col="red")
lines(x = date ,y = range01(as.numeric(hilomodified$saltppt[index])), type = "l",lwd=2, col="green")
lines(x = date ,y = range01(as.numeric(hilomodified$TempC[index])), type = "l",lwd=2, col="orange")
lines(x = date ,y = range01(as.numeric(hilomodified$Doper[index])), type = "l",lwd=2, col="purple")
axis(side = 4)   # Add second axis
#mtext("y2", side = 4, line = 3) # Add second axis label
text(x= enddate, y = endcms, col = "black", adj=1, cex=0.85, label= "River Flow")
text(x= enddate, y = endchl, col = "blue", adj=1, cex=0.85, label= "CHL")
text(x= enddate, y = endturb, col = "red", adj=1, cex=0.85, label= "TURB")
text(x= enddate, y = endsalt, col = "green", adj=1, cex=0.85, label= "Salinity")
text(x= enddate, y = endtemp, col = "orange", adj=1, cex=0.85, label= "TEMP")
text(x= enddate, y = endDO, col = "purple", adj=1, cex=0.85, label= "DIS")
}
for(i in 1:length(start)){
index <- c((start[i]-24):(end[i]+24))
TF <-  (is.na(as.numeric(hilomodified$ChlRFU[index]))  && is.na(as.numeric(hilomodified$Corr.NTU[index])) && is.na(as.numeric(hilomodified$saltppt[index])) && is.na(as.numeric(hilomodified$TempC[index])) && is.na(as.numeric(hilomodified$Doper[index])))
if(TF == FALSE){plot(0,0)}
date <- c(hilomodified$date[index])
enddate <- hilomodified$date[end[i]+24]
endcms <- as.numeric(hilomodified$cms[end[i]+24])
endchl <- range01(as.numeric(hilomodified$cms[end[i]+24]))
endturb <- as.numeric(hilomodified$cms[end[i]+24])
endsalt <- as.numeric(hilomodified$cms[end[i]+24])
endtemp <- as.numeric(hilomodified$cms[end[i]+24])
endDO <- as.numeric(hilomodified$cms[end[i]+24])
par(mar = c(5, 4, 4, 4) + 0.3) # Additional space for second y-axis
plot(x = date,y = as.numeric(hilomodified$cms[index]), type = "l",lwd=2, col="black", xlab="Time") # Create first plot for River Flow
par(new = TRUE) # Add new plot
plot(x = date ,y = range01(as.numeric(hilomodified$ChlRFU[index])),axes = FALSE, type = "l",lwd=2, col="blue", ylab = "Time")  # Create second plot without axes
lines(x = date ,y = range01(as.numeric(hilomodified$Corr.NTU[index])), type = "l",lwd=2, col="red")
lines(x = date ,y = range01(as.numeric(hilomodified$saltppt[index])), type = "l",lwd=2, col="green")
lines(x = date ,y = range01(as.numeric(hilomodified$TempC[index])), type = "l",lwd=2, col="orange")
lines(x = date ,y = range01(as.numeric(hilomodified$Doper[index])), type = "l",lwd=2, col="purple")
axis(side = 4)   # Add second axis
#mtext("y2", side = 4, line = 3) # Add second axis label
text(x= enddate, y = endcms, col = "black", adj=1, cex=0.85, label= "River Flow")
text(x= enddate, y = endchl, col = "blue", adj=1, cex=0.85, label= "CHL")
text(x= enddate, y = endturb, col = "red", adj=1, cex=0.85, label= "TURB")
text(x= enddate, y = endsalt, col = "green", adj=1, cex=0.85, label= "Salinity")
text(x= enddate, y = endtemp, col = "orange", adj=1, cex=0.85, label= "TEMP")
text(x= enddate, y = endDO, col = "purple", adj=1, cex=0.85, label= "DIS")
}
for(i in 1:length(start)){
index <- c((start[i]-24):(end[i]+24))
TF <-  (is.na(as.numeric(hilomodified$ChlRFU[index]))| is.na(as.numeric(hilomodified$Corr.NTU[index])) | is.na(as.numeric(hilomodified$saltppt[index])) | is.na(as.numeric(hilomodified$TempC[index])) | is.na(as.numeric(hilomodified$Doper[index])))
if(TF == FALSE){plot(0,0)}
date <- c(hilomodified$date[index])
enddate <- hilomodified$date[end[i]+24]
endcms <- as.numeric(hilomodified$cms[end[i]+24])
endchl <- range01(as.numeric(hilomodified$cms[end[i]+24]))
endturb <- as.numeric(hilomodified$cms[end[i]+24])
endsalt <- as.numeric(hilomodified$cms[end[i]+24])
endtemp <- as.numeric(hilomodified$cms[end[i]+24])
endDO <- as.numeric(hilomodified$cms[end[i]+24])
par(mar = c(5, 4, 4, 4) + 0.3) # Additional space for second y-axis
plot(x = date,y = as.numeric(hilomodified$cms[index]), type = "l",lwd=2, col="black", xlab="Time") # Create first plot for River Flow
par(new = TRUE) # Add new plot
plot(x = date ,y = range01(as.numeric(hilomodified$ChlRFU[index])),axes = FALSE, type = "l",lwd=2, col="blue", ylab = "Time")  # Create second plot without axes
lines(x = date ,y = range01(as.numeric(hilomodified$Corr.NTU[index])), type = "l",lwd=2, col="red")
lines(x = date ,y = range01(as.numeric(hilomodified$saltppt[index])), type = "l",lwd=2, col="green")
lines(x = date ,y = range01(as.numeric(hilomodified$TempC[index])), type = "l",lwd=2, col="orange")
lines(x = date ,y = range01(as.numeric(hilomodified$Doper[index])), type = "l",lwd=2, col="purple")
axis(side = 4)   # Add second axis
#mtext("y2", side = 4, line = 3) # Add second axis label
text(x= enddate, y = endcms, col = "black", adj=1, cex=0.85, label= "River Flow")
text(x= enddate, y = endchl, col = "blue", adj=1, cex=0.85, label= "CHL")
text(x= enddate, y = endturb, col = "red", adj=1, cex=0.85, label= "TURB")
text(x= enddate, y = endsalt, col = "green", adj=1, cex=0.85, label= "Salinity")
text(x= enddate, y = endtemp, col = "orange", adj=1, cex=0.85, label= "TEMP")
text(x= enddate, y = endDO, col = "purple", adj=1, cex=0.85, label= "DIS")
}
for(i in 1:length(start)){
index <- c((start[i]-24):(end[i]+24))
TF <-  (is.na(as.numeric(hilomodified$ChlRFU[index]))| is.na(as.numeric(hilomodified$Corr.NTU[index])) | is.na(as.numeric(hilomodified$saltppt[index])) | is.na(as.numeric(hilomodified$TempC[index])) | is.na(as.numeric(hilomodified$Doper[index])))
if(TF == TRUE){plot(0,0)}
date <- c(hilomodified$date[index])
enddate <- hilomodified$date[end[i]+24]
endcms <- as.numeric(hilomodified$cms[end[i]+24])
endchl <- range01(as.numeric(hilomodified$cms[end[i]+24]))
endturb <- as.numeric(hilomodified$cms[end[i]+24])
endsalt <- as.numeric(hilomodified$cms[end[i]+24])
endtemp <- as.numeric(hilomodified$cms[end[i]+24])
endDO <- as.numeric(hilomodified$cms[end[i]+24])
par(mar = c(5, 4, 4, 4) + 0.3) # Additional space for second y-axis
plot(x = date,y = as.numeric(hilomodified$cms[index]), type = "l",lwd=2, col="black", xlab="Time") # Create first plot for River Flow
par(new = TRUE) # Add new plot
plot(x = date ,y = range01(as.numeric(hilomodified$ChlRFU[index])),axes = FALSE, type = "l",lwd=2, col="blue", ylab = "Time")  # Create second plot without axes
lines(x = date ,y = range01(as.numeric(hilomodified$Corr.NTU[index])), type = "l",lwd=2, col="red")
lines(x = date ,y = range01(as.numeric(hilomodified$saltppt[index])), type = "l",lwd=2, col="green")
lines(x = date ,y = range01(as.numeric(hilomodified$TempC[index])), type = "l",lwd=2, col="orange")
lines(x = date ,y = range01(as.numeric(hilomodified$Doper[index])), type = "l",lwd=2, col="purple")
axis(side = 4)   # Add second axis
#mtext("y2", side = 4, line = 3) # Add second axis label
text(x= enddate, y = endcms, col = "black", adj=1, cex=0.85, label= "River Flow")
text(x= enddate, y = endchl, col = "blue", adj=1, cex=0.85, label= "CHL")
text(x= enddate, y = endturb, col = "red", adj=1, cex=0.85, label= "TURB")
text(x= enddate, y = endsalt, col = "green", adj=1, cex=0.85, label= "Salinity")
text(x= enddate, y = endtemp, col = "orange", adj=1, cex=0.85, label= "TEMP")
text(x= enddate, y = endDO, col = "purple", adj=1, cex=0.85, label= "DIS")
}
for(i in 1:length(start)){
index <- c((start[i]-24):(end[i]+24))
# TF <-  (is.na(as.numeric(hilomodified$ChlRFU[index]))| is.na(as.numeric(hilomodified$Corr.NTU[index])) | is.na(as.numeric(hilomodified$saltppt[index])) | is.na(as.numeric(hilomodified$TempC[index])) | is.na(as.numeric(hilomodified$Doper[index])))
# if(TF == TRUE){plot(0,0)}
date <- c(hilomodified$date[index])
enddate <- hilomodified$date[end[i]+24]
endcms <- as.numeric(hilomodified$cms[end[i]+24])
endchl <- range01(as.numeric(hilomodified$cms[end[i]+24]))
endturb <- as.numeric(hilomodified$cms[end[i]+24])
endsalt <- as.numeric(hilomodified$cms[end[i]+24])
endtemp <- as.numeric(hilomodified$cms[end[i]+24])
endDO <- as.numeric(hilomodified$cms[end[i]+24])
par(mar = c(5, 4, 4, 4) + 0.3) # Additional space for second y-axis
plot(x = date,y = as.numeric(hilomodified$cms[index]), type = "l",lwd=2, col="black", xlab="Time") # Create first plot for River Flow
par(new = TRUE) # Add new plot
plot(x = date ,y = range01(as.numeric(hilomodified$ChlRFU[index])),axes = FALSE, type = "l",lwd=2, col="blue", ylab = "Time")  # Create second plot without axes
lines(x = date ,y = range01(as.numeric(hilomodified$Corr.NTU[index])), type = "l",lwd=2, col="red")
lines(x = date ,y = range01(as.numeric(hilomodified$saltppt[index])), type = "l",lwd=2, col="green")
lines(x = date ,y = range01(as.numeric(hilomodified$TempC[index])), type = "l",lwd=2, col="orange")
lines(x = date ,y = range01(as.numeric(hilomodified$Doper[index])), type = "l",lwd=2, col="purple")
axis(side = 4)   # Add second axis
#mtext("y2", side = 4, line = 3) # Add second axis label
text(x= enddate, y = endcms, col = "black", adj=1, cex=0.85, label= "River Flow")
text(x= enddate, y = endchl, col = "blue", adj=1, cex=0.85, label= "CHL")
text(x= enddate, y = endturb, col = "red", adj=1, cex=0.85, label= "TURB")
text(x= enddate, y = endsalt, col = "green", adj=1, cex=0.85, label= "Salinity")
text(x= enddate, y = endtemp, col = "orange", adj=1, cex=0.85, label= "TEMP")
text(x= enddate, y = endDO, col = "purple", adj=1, cex=0.85, label= "DIS")
}
range01 <- function(x){(x-min(x))/(max(x)-min(x))}
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
#p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~., name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
p <- p + ggtitle("Storms")+labs(x="Time")
print(p)
}
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
#p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~.10, name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
p <- p + ggtitle("Storms")+labs(x="Time")
print(p)
}
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
#p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~.*10, name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
p <- p + ggtitle("Storms")+labs(x="Time")
print(p)
}
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
#p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~.*1, name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
p <- p + ggtitle("Storms")+labs(x="Time")
print(p)
}
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
#p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~.*.1, name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
p <- p + ggtitle("Storms")+labs(x="Time")
print(p)
}
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
#p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~.*.08, name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
p <- p + ggtitle("Storms")+labs(x="Time")
print(p)
}
library(ggplot2)
for(i in 1:length(start)){
# the point start[i] is the beginning of a storm
# the point end[i] is the end of the same storm
# we are adding 24 hours to each start and end time
p <- ggplot(hilomodified[(start[i]-24):(end[i]+24),],aes(x = date, y = as.numeric(cms))) +
geom_line(color="black")
p <- p + geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green")
#p <- p + geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue")
p <- p + scale_y_continuous(name = "First Axis", sec.axis = sec_axis(trans = ~.*.05, name="Second Axis")
)
# geom_line(aes(y = range01(as.numeric(Corr.NTU))), color="green") +
# geom_line(aes(y= range01(as.numeric(ChlRFU))),color="blue") +
# geom_line(aes(y = range01(as.numeric(saltppt))),color="red") +
# geom_line(aes(y = range01(as.numeric(TempC))),color="purple") +
# geom_line(aes(y = range01(as.numeric(Doper))),color="orange")+
p <- p + ggtitle("Storms")+labs(x="Time")
print(p)
}
