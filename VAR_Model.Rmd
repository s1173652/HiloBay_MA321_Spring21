---
title: "R Notebook"
output: html_notebook
---

# Example

```{r}
#install.packages("vars") 
#install.packages("astsa") 
library(vars)
library(astsa)

#creates a vector of response variables
x = cbind(cmort, tempr, part) 

#VAR command does estimation of AR models using ordinary least squares while simultaneously fitting the trend, intercept, and ARIMA model
plot.ts(x , main = "", xlab = "")
fitvar1= VAR(x, p=1, type="both")
summary(fitvar1)
```

```{r}
# Removing NAs
hilo2015[is.na(hilo2015)] <- 0
sum(is.na(hilo2015))

# Saving as numeric vectors
riverflow <- as.numeric(hilo2015$cms)
chlorophyll <- as.numeric(hilo2015$ChlRF)
dissolved_o2 <- as.numeric(hilo2015$Doper)
salinity <- as.numeric(hilo2015$saltppt)
temp <- as.numeric(hilo2015$TempC)
turbidity <- as.numeric(hilo2015$Corr.NTU)

#creates a vector of response variables
h = cbind(riverflow, chlorophyll, dissolved_o2, salinity, temp, turbidity) 
# hilo2015$saltppt, hilo2015$TempC, hilo2015$Corr.NTU

#VAR command does estimation of AR models using ordinary least squares while simultaneously fitting the trend, intercept, and ARIMA model
plot.ts(h , main = "", xlab = "")
fitvar1= VAR(h, p=1, type="both")
summary(fitvar1)
```

```{r}
# 2nd Lag
fitvar2 = VAR(h, p=2, type="both")
summary(fitvar2)
```


```{r}
# Ask about what this is

acf(residuals(fitvar2)[,1], plot = FALSE)
acf(residuals(fitvar2)[,2])
acf(residuals(fitvar2)[,3])
acf(residuals(fitvar2)[,4])
acf(residuals(fitvar2)[,5])
acf(residuals(fitvar2)[,6])
```

```{r}
cmsturb <- irf(fitvar2, impulse = "riverflow", response = "turbidity", n.ahead = 8, ortho = FALSE, runs = 1000)
cmsturb
plot(cmsturb)
```

```{r}
cmssalin <- irf(fitvar2, impulse = "riverflow", response = "salinity", n.ahead = 8, ortho = FALSE, runs = 1000)
cmssalin
plot(cmssalin)
```


```{r}
cmschlor <- irf(fitvar2, impulse = "riverflow", response = "chlorophyll", n.ahead = 8, ortho = FALSE, runs = 1000)
cmschlor
plot(cmschlor)
```

```{r}
cmsdisso2 <- irf(fitvar2, impulse = "riverflow", response = "dissolved_o2", n.ahead = 8, ortho = FALSE, runs = 1000)
cmsdisso2
plot(cmsdisso2)
```

```{r}
cmstemp <- irf(fitvar2, impulse = "riverflow", response = "temp", n.ahead = 8, ortho = FALSE, runs = 1000)
cmstemp
plot(cmstemp)
```

```{r}
hilo2015$logcms <- NULL
hilo2015$chlcal <- NULL
hilo2015$ChlRF <- NULL
```

 
























